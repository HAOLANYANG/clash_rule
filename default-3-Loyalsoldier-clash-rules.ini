mixed-port: 10801
external-controller: '127.0.0.1:9091'
allow-lan: false
bind-address: "*"
find-process-mode: strict

mode: rule
geox-url:
  geoip: "https://cdn.jsdelivr.net/gh/Loyalsoldier/v2ray-rules-dat@release/geoip.dat"
  geosite: "https://cdn.jsdelivr.net/gh/Loyalsoldier/v2ray-rules-dat@release/geosite.dat"
  mmdb: "https://cdn.jsdelivr.net/gh/Loyalsoldier/geoip@release/Country.mmdb"
  asn: "https://cdn.jsdelivr.net/gh/Loyalsoldier/geoip@release/GeoLite2-ASN.mmdb"

geo-auto-update: true # æ˜¯å¦è‡ªåŠ¨æ›´æ–° geodata
geo-update-interval: 24 # æ›´æ–°é—´éš”ï¼Œå•ä½ï¼šå°æ—¶
log-level: silent

ipv6: false

hosts:
    dns.google: 8.8.8.8
    dns.alidns.com: 223.5.5.5
    doh.pub: 1.12.12.12
    dot.pub: 120.53.53.53
    doh.opendns.com: 208.67.222.222
profile: 
  # å­˜å‚¨ select é€‰æ‹©è®°å½•
  store-selected: false
  # æŒä¹…åŒ– fake-ip
  store-fake-ip: true
tun:
    enable: true
    stack: gvisor
    dns-hijack: ['any:53', 'tcp://any:53']
    udp-timeout: 300
    auto-route: true
    strict-route: true
    auto-redirect: false
    auto-detect-interface: true
    route-exclude-address: [192.168.0.0/16, 'fc00::/7']
    exclude-package: [com.tencent.tmgp.sgame, com.tencent.tmgp.pubgmhd, com.tencent.jkchess]

dns:
    cache-algorithm: arc
    enable: true
    prefer-h3: true
    use-hosts: true
    use-system-hosts: true
    listen: 0.0.0.0:1053 # å¼€å¯ DNS æœåŠ¡å™¨ç›‘å¬
    enhanced-mode: fake-ip
    fake-ip-range: 28.0.0.1/8
    fake-ip-filter:
      - '+.lan'
      - '+.local' 
      - '*.localdomain'
      - miwifi.com
      - "rule-set:private,direct,icloud,apple"
      - '+.lan'
      - '+.local' 
      - '*.localdomain'
      - miwifi.com
      - '*.example'
      - '*.invalid'
      - '*.localhost'
      - '*.test'
      - '*.local'
      - "*.home.arpa"
      - "stun.*"
      - "+.stun.com"
      - "+.qq.com"
      - "+.tencent.com"
      - "+.doh.pub"
      - "sm2.doh.pub"
      - "qlogo.cn"
      - "*.qlogo.cn"
      - "connect.rom.miui.com"
      - "WORKGROUP"
      - "localhost.ptlogin2.qq.com"
      - "+.market.xiaomi.com"
      - "+.cmbchina.com"
      - "+.cmbimg.com"
      - "*.mcdn.bilivideo.cn"
      - "+.apple.com"
      - "lens.l.google.com"
      - "stun.l.google.com"- "na.b.g-tun.com"
      - 'time.*.com'
      - 'time.*.gov'
      - 'time.*.edu.cn'
      - 'time.*.apple.com'
      - 'time1.*.com'
      - 'time2.*.com'
      - 'time3.*.com'
      - 'time4.*.com'
      - 'time5.*.com'
      - 'time6.*.com'
      - 'time7.*.com'
      - 'ntp.*.com'
      - 'ntp1.*.com'
      - 'ntp2.*.com'
      - 'ntp3.*.com'
      - 'ntp4.*.com'
      - 'ntp5.*.com'
      - 'ntp6.*.com'
      - 'ntp7.*.com'
      - '*.time.edu.cn'
      - '*.ntp.org.cn'
      - '+.pool.ntp.org'
      - 'time1.cloud.tencent.com'
      - '+.pub.3gppnetwork.org'
    fake-ip-filter-mode: blacklist
    respect-rules: false #ä¸ºtrueåˆ™dnsæŸ¥è¯¢èµ°è§„åˆ™
    default-nameserver: # ç”¨äºè§£æ nameserverï¼Œfallback ä»¥åŠå…¶ä»– DNS æœåŠ¡å™¨é…ç½®çš„ï¼ŒDNS æœåŠ¡åŸŸå
      - 114.114.114.114
      - tls://1.12.12.12:853
      - tls://223.5.5.5:853
      - system # append DNS server from system configuration. If not found, it would print an error log and skip.
    nameserver:
      - https://8.8.4.4/dns-query#ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - https://8.8.8.8/dns-query#ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - https://1.1.1.1/dns-query#ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - https://1.0.0.1/dns-query#ğŸš€ èŠ‚ç‚¹é€‰æ‹©
    nameserver-policy:
        "rule-set:private,direct,icloud,apple":
          - https://223.5.5.5/dns-query
          - https://sm2.doh.pub/dns-query
          - https://1.12.12.12/dns-query
        "geosite:google":
          - https://8.8.8.8/dns-query#ğŸš€ èŠ‚ç‚¹é€‰æ‹©
          - https://8.8.4.4/dns-query#ğŸš€ èŠ‚ç‚¹é€‰æ‹©
    proxy-server-nameserver:
      - https://8.8.4.4/dns-query#ğŸš€ èŠ‚ç‚¹é€‰æ‹©
      - https://223.5.5.5/dns-query
      - https://223.6.6.6/dns-query
      - https://1.12.12.12/dns-query

proxies:
  
proxy-groups:
  - name: "ğŸš€ èŠ‚ç‚¹é€‰æ‹©"
    type: select
    udp: true
    proxies:
      - â™»ï¸ å»¶è¿Ÿæœ€ä½
      - ğŸ”¯ æ•…éšœè½¬ç§»
      - ğŸ‡­ğŸ‡° é¦™æ¸¯
      - ğŸ‡¹ğŸ‡¼ å°æ¹¾
      - ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡
      - ğŸ‡¯ğŸ‡µ æ—¥æœ¬
      - ğŸ‡ºğŸ‡² ç¾å›½
      - ğŸŒ å…¶å®ƒåœ°åŒº
      - ğŸŒ  IPLCä¸“çº¿
  - name:ğŸŒ å…¶å®ƒåœ°åŒº
    type: select
    udp: true
    filter: "éŸ©|é¦–å°”|é©¬|å‰éš†å¡"
  - name: ğŸ‡­ğŸ‡° é¦™æ¸¯
    type: url-test
    udp: true
    filter: "æ¸¯|HK|hk|Hong Kong|HongKong|hongkong"
    url: "https://cp.cloudflare.com/generate_204"
    interval: 300
  - name:ğŸ‡¹ğŸ‡¼ å°æ¹¾
    type: url-test
    udp: true
    filter: "å°|æ–°åŒ—|å½°åŒ–|TW||twTaiwan"
    url: "https://cp.cloudflare.com/generate_204"
    interval: 300
  - name:ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡
    type: url-test
    udp: true
    filter: "æ–°åŠ å¡|å¡|ç‹®åŸ|SG|sg|Singapore"
    url: "https://cp.cloudflare.com/generate_204"
    interval: 300
  - name:ğŸ‡¯ğŸ‡µ æ—¥æœ¬
    type: url-test
    udp: true
    filter: "æ—¥æœ¬|å·æ—¥|ä¸œäº¬|å¤§é˜ª|æ³‰æ—¥|åŸ¼ç‰|æ²ªæ—¥|æ·±æ—¥|JP|jp|Japan"
    url: "https://cp.cloudflare.com/generate_204"
    interval: 300
  - name:ğŸ‡ºğŸ‡² ç¾å›½
    type: url-test
    udp: true
    filter: "ç¾|æ³¢ç‰¹å…°|è¾¾æ‹‰æ–¯|ä¿„å‹’å†ˆ|å‡¤å‡°åŸ|è´¹åˆ©è’™|ç¡…è°·|ç›åŸ|æ‹‰æ–¯ç»´åŠ æ–¯|æ´›æ‰çŸ¶|åœ£ä½•å¡|åœ£å…‹æ‹‰æ‹‰|è¥¿é›…å›¾|èŠåŠ å“¥|US|us|United States"
    url: "https://cp.cloudflare.com/generate_204"
    interval: 300
  - name: "ğŸ”¯ æ•…éšœè½¬ç§»"
    type: fallback
    udp: true
    url: "https://cp.cloudflare.com/generate_204"
    interval: 30
  - name: "â™»ï¸ å»¶è¿Ÿæœ€ä½"
    type: url-test
    udp: true
    proxies:
    url: "https://cp.cloudflare.com/generate_204"
    interval: 300
  - name: "ğŸ¯ å…¨çƒç›´è¿"
    type: direct
    udp: true

rule-providers:

  icloud:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/icloud.txt"
    path: ./ruleset/icloud.yaml
    interval: 86400

  apple:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/apple.txt"
    path: ./ruleset/apple.yaml
    interval: 86400

  google:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/google.txt"
    path: ./ruleset/google.yaml
    interval: 86400

  proxy:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/proxy.txt"
    path: ./ruleset/proxy.yaml
    interval: 86400

  direct:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt"
    path: ./ruleset/direct.yaml
    interval: 86400

  private:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt"
    path: ./ruleset/private.yaml
    interval: 86400

  gfw:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/gfw.txt"
    path: ./ruleset/gfw.yaml
    interval: 86400

  tld-not-cn:
    type: http
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/tld-not-cn.txt"
    path: ./ruleset/tld-not-cn.yaml
    interval: 86400

  telegramcidr:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/telegramcidr.txt"
    path: ./ruleset/telegramcidr.yaml
    interval: 86400

  cncidr:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt"
    path: ./ruleset/cncidr.yaml
    interval: 86400

  lancidr:
    type: http
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt"
    path: ./ruleset/lancidr.yaml
    interval: 86400

  applications:
    type: http
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt"
    path: ./ruleset/applications.yaml
    interval: 86400

rules:
  - RULE-SET,applications,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,private,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,icloud,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,apple,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,google,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - RULE-SET,proxy,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
  - RULE-SET,direct,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,lancidr,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,cncidr,ğŸ¯ å…¨çƒç›´è¿
  - RULE-SET,telegramcidr,PROXY
  - GEOIP,LAN,ğŸ¯ å…¨çƒç›´è¿
  - GEOIP,CN,ğŸ¯ å…¨çƒç›´è¿
  - MATCH,ğŸš€ èŠ‚ç‚¹é€‰æ‹©
